---
title: "Math 315 F16: Homework 2"
author: "Junxiong Liu" 
date: "Due by midnight, Sunday Sept. 25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse=TRUE, prompt=TRUE,comment=NULL,message=FALSE, include=TRUE)
```

Place your homework assignment .Rmd and html/pdf/word docs in the hand-in folder by the given deadline. Also let me know: 

**Who did you work with:**I worked with Ruyi on some parts of  this assignment.

Note: *(s) only for my notation use to mark the relatively tricky one for me.

### Problem 1
Write a short R function (less than 10 lines) that does something interesting! Also explain its inputs (objects, arguments) and output(s) and run the function to demonstrate its use. If one of your inputs is data, you can use any data source that you like (or just make up your own data frame).

*answer:* 

This interesting function is taking in the users' input of mean and standard deviation, and output whether the standard deviation is relatively high and the range of 50 points randomly generated by input mean and SD. The inputs are two vector objects of length 1 and numeric type without default values, so the arguments must take in two numeric values for this function to work. It will output a dataframe object with two attributes: sd_approx and range, containing factor type and numeric type values, respectively. 

```{r Problem 1 Interesting Function}

myfunction <- function (meanNum,sdNum){
  if (sdNum/meanNum >= 1){
    sd_approx <- "You probably have a relatively high standard deviation"
  }else{
    sd_approx <- "You probably have a relatively low standard deviation"
  }
  full_list <- rnorm (50,meanNum,sdNum) #create a list of numbers generated by normal distribution of mean=meanNum and sd=sdNum
  range <- max(full_list)-min(full_list)
  return(data.frame(sd_approx,range))
}

#For examination
myfunction(2,1)
myfunction(2,3)
myfunction(2,5)

is.vector(myfunction(2,1))
is.list(myfunction(2,1))
is.data.frame(myfunction(2,1))

class(myfunction(2,1)$sd_approx)
class(myfunction(2,1)$range)
```

### Problem 2
Textbook exercise 2.2. Here is the [referenced NYT website](http://www.nytimes.com/2012/04/15/sunday-review/coming-soon-taxmageddon.html?_r=0), the graphs are in the links at the bottom of the article. 

*answer:*

**Question 1.**

In the first graph about change in Federal tax rate, the wealthy groups seem to have a very deep downward trend for tax rates across years, especially the top 0.01% income group, whose tax rate drops from 71.4% to 34.2%. In the second graph showing the largest kinds of tax breaks, the graph wants to emphasize that most money in the biggest tax break (Exclusion) goes to top 20% income groups. Therefore, both graphs try to tell that the tax cuts actually benefit the wealthier groups more than the poorer groups.

**Question 2. **

In the first graph, the panel "Segement of Income Distribution" is misleading because for the top 20% income section, the top 0.01% is included in top 0.1%, and the top 0.01% and top 0.1% are included in top 1% and so on. Also, the position of this income distribution panel is problematic and might be misread as y axis. In addition, the x-axis and y-axis in this figure is not clearly labelled. 

The second graph is also not clearly labelled in both x and y axis. In addition, as I assume that this is a proportion graph where y axis represents the proportion of each income group for each bar (so y axis should be added up to 1 for each), the bar of "refundable credits" and "misc provisions" are both problematic because neither add up to 1. Refundable credit bar adds up to 99.6% and the misc probisions bar adds up to 99.9%, which implies an inconsistent y-axis (coordinate system). Finally, considering the position of the bars, the bottom part of each bar should have been aligned, not like this.

**Question 3.**

For graph 1, we note there is information about "change in real, pre-tax income 1960-2004", where 4 of the 8 income groups have NAs, which means that this information is not telling much and there is no need to list it out. Thus, it is suspicious that the only reason to include this is to mislead the readers toward the direction supporting the authors' ideas. For graph 2, since each income group is seen "as a whole", we don't know how many people are there in each income group, which might result in misleading judgements. Also, the graph 2 only considers the data for the year of 2011 and cannot/should not be generalized to the greater setting "Who gains more from tax breaks", which sounds like this is true for all years while the data not necessarily supports.

### Problem 3
Textbook exercise 2.4. Here a [link to the website](http://mdsr-book.github.io/exercises.html).

*answer:*

**1. First linke about data scientist: **

(1)The first link (data scientists) contains many graphics of cool colors (grey, blue, etc), but it lacks warm colors. It could have been better if, for instance, use cool colors to represent data scientist and warm colors to represent business intelligence people. 

(2)Also, all graphics are not labelled, and it would have been better to have them labelled. 

(3)Since the main aim of the report is to answer the three questions "Who are data scientist practitioners, what skills they need and why are they so different", it could have been better to break the report to this three sections with graphs answering each of the question.

(4)There are no title for the graphs, and we are not able to get the information immediately after looking at the graphs. If I were the author, I would have added the titles or include the graphs with titles.

**2. Second link about American food: **

(1)I think overall the second link presents too much information. Even though there are subtitles to summarize the sections, I am still a bit overwhelmed. If I were the author, I will pick the ones that can best reflect the subtitle. 

(2)Some graphs are also untitled and/or unlabelled (e.g. Graph 2, Graph 4, Graph 14..). If I were the editor, I will get rid of such graphs.

### Problem 4
Textbook exercise 2.5. Use the same link as problem 3. Not that the link to the first possible data graphic (Health InfoScape) seems to be broken. Keep in mind you only need to analyze **one** graph. 

*answer:*

I am looking at No.3, the wind map

1. The wind map interactively tells the data of wind. It contains many data points across the U.S. and gives us a general trend of the wind with its animation (speed, direction at the point of mouse). As we zoom in, we are able to get the wind information in smaller areas.The main takeaway I got from this is the general wind trend in biggger areas (e.g. California area), along with the trend in specific areas if I need.

2. This cannot be described in the taxonomy in this chapter. A feature of this data graphic that lies outside of the taxonomy is the visual cues. Given the auto-animation and every-second-changing property of this graph, it seems hard to fit the nine categories of visual cues. For instance, it seems hard to describe the slope and shape as the interactive graph is changing every second according to wind direction and speed.

3. I think the visualization is brilliant and works well. It does not only give the big picture by its automatic animation, but also can give us specific idea about certain areas as we zoom in. If I could manage this graphic, I would add an "search location" button based on the existing graphic. As we enter the information about a specific location in search, we would be able to zoom into this location, get the current data of the wind speed at this location and some past data.

### Problem 5
Textbook exercise 3.1. (You will need to install/load the package `mosaicData` to get to this dataset.)

*answer:*
Here is the picture and the red lines are the regression lines generated by applying linear regression models to two facets separately.
```{r Problem 5}
library(mosaicData)
library(ggplot2)
head(Galton)

p <- ggplot(Galton,aes(y=height,x=father))
p + geom_point() + geom_smooth(method="lm",color="red",se=FALSE) + facet_grid(~sex) + xlab("Father's height") + ylab("Child's height") + ggtitle("Child's height against father's height conditioned on gender")
```


### Problem 6
Textbook exercise 3.4. 

*answer:*

**1. **

The scatterplot seems to show that the number of previous marriage is positively assoicated with age (as age increases, the number of previous marriage seems to be very likely to increase)
```{r Problem 5 Q1}
head(Marriage,2)

ggplot(Marriage,aes(x=age,y=prevcount)) + geom_point() + geom_smooth(method = "lm",color="blue",se=FALSE) + xlab("Age") + ylab("Number of previous marriage") + ggtitle("Scatterplot for number of previous marriage against age")
```

**2.**

Position: the x and y coordinates decide the position of each person in the scatterplot and how they are related (e.g. if y1 (for person 1) is bigger than y2 (for person 2))

Direction: it seems that the points generally have a positive trend

Color: There is a dark blue fitted linear regression line, and the dots are black. The grid on the background is light grey.

**3.**
```{r Problem 5 Q3}
ggplot(Marriage,aes(x=age,y=delay)) + geom_point(aes(color=person,size=prevcount)) + facet_grid(~race) + ylab("Number of delays between appliation and ceremony") + ggtitle("Delay time against age conditioned race,person and number of previous marriages")
```

### Problem 7
Textbook exercises 3.9 and 3.10. The data for these is the data frame `storms` in the `nasaweather` package. For 3.10, if you want to use color to distinguish storms but not include the legend of storm names/colors you can add `scale_color_discrete(guide="none")`.

*answer:*
```{r Problem 7 Part 1 3.9}
#Exercise 3.9
library(nasaweather)
head(storms,2)

ggplot(storms,aes(y=pressure,x=wind)) + geom_point(aes(color=type)) + ggtitle("Scatterplot for pressure against wind conditioned on type of storm")
```

```{r Problem 7 Part 2 3.10}
ggplot(storms,aes(x=long,y=lat)) + geom_path(aes(color=name)) + facet_wrap(~year) + scale_color_discrete(guide="none") + ggtitle("Path of the storms from 1995 to 2000") + xlab("longitude") + ylab("latitude")
```

### Problem 8
Revist exercise 3.1 (problem 5). Instead of faceting by `sex`, use `sex` to color the points in your scatterplot and include regression lines. Use a color scheme for the points that is not the default coloring (see Friday's examples). 

*answer:*
```{r Problem 8 Exercise 3.1 edited}
p <- ggplot(Galton,aes(y=height,x=father,color=sex))
p + geom_point() + scale_color_brewer(palette="Set1")  + geom_smooth(method="lm",se=FALSE) + xlab("Father's height") + ylab("Child's height") + ggtitle("Child's height against father's height conditioned on gender")
```

### Problem 9
Revist the `storms` data used in problem 7. Use `ggplot` to create a stacked bar graph that shows the proportion of storm `type` that occur each `year`. Use `scale_fill_brewer` or `scale_fill_manual` to change the default coloring of the bars.

*answer:*
```{r Problem 9 Exercise 3.9 edited}
library(scales)
ggplot(data=storms,aes(x=as.factor(year),fill=type)) + geom_bar(position = "fill") + scale_fill_brewer(name="type",palette="Set1") + 
  ggtitle("Proportion of each type of storm type for each year") + ylab("Proportion") + xlab("year") + scale_y_continuous(labels = percent)
```

### Extra Credit
Textbook exercise 3.5. This is just for fun - I want to see if anyone can get 7 variables!

*answer:*
```{r Exercise 3.5}
library(mdsr)
head(MLB_teams,2)

#seven variables: log(payroll), log(metroPop), teamID, normAttend, WPct, lgID, yearID
ggplot(MLB_teams,aes(x=log(payroll),y=log(metroPop))) + geom_point(aes(color=teamID,size=normAttend,alpha=WPct)) + facet_wrap(lgID~yearID) + ggtitle("A somehow funny graph with 7 variables")
```

